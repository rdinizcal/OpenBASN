scale_color_manual(values = c("ok" = 'blue', "not ok" = 'red'), name = "") +
labs(title="BSN overall cost over time for controlled system",x="time (s)", y="cost")
cost <- plot_grid(nc_cost, c_cost, ncol = 1, align = 'v')
# plot all
plot_grid(rel, cost)
# Experiments for 4B
## Reliability analysis
r <- 0.90
nc_rel <- nc_data %>%
mutate(color = if_else(RELIABILITY>=r*0.95 & RELIABILITY<=r*1.05, "88%<x<92%", "x<88% or x>92%")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000,RELIABILITY*100, color=color)) +
stat_smooth(aes(TIME..ms./1000,RELIABILITY*100), color='black', method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_hline(yintercept = (r*0.95)*100, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = (r*100), color = 'black') +
#geom_hline(yintercept = (r*1.05)*100, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./25, name="active sensors")) +
scale_color_manual(values = c("88%<x<92%" = 'blue', "x<88% or x>92%" = 'red'), name = "") +
labs(title="BSN overall reliability over time for non-controlled system",x="time (s)", y="reliability (%)")
#coord_cartesian(xlim=c(0, 30), ylim=c(0, 100))
c_rel <- c_data %>%
mutate(color = if_else(RELIABILITY>=r*0.95 & RELIABILITY<=r*1.05, "88%<x<92%", "x<88% or x>92%")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000,RELIABILITY*100, color=color)) +
stat_smooth(aes(TIME..ms./1000,RELIABILITY*100), color='black', method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_hline(yintercept = (r*0.95)*100, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = (r*100), color = 'black') +
#geom_hline(yintercept = (r*1.05)*100, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./25, name="active sensors")) +
scale_color_manual(values = c("88%<x<92%" = 'blue', "x<88% or x>92%" = 'red'), name = "") +
labs(title="BSN overall reliability over time for controlled system",x="time (s)", y="reliability (%)")
#coord_cartesian(xlim=c(0, 30), ylim=c(0, 100))
rel <- plot_grid(nc_rel, c_rel, ncol = 1, align = 'v')
## Cost analysis
c <- 0.47
nc_cost <- nc_data %>%
mutate(color = if_else(c*0.95<COST & COST<c*1.05,"ok", "not ok")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000, COST, color=color)) +
stat_smooth(aes(TIME..ms./1000,COST), color='black', method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_hline(yintercept = c*0.95, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = c, color = 'black') +
#geom_hline(yintercept = c*1.05, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*0.15), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.15, name="active sensors")) +
scale_color_manual(values = c("ok" = 'blue', "not ok" = 'red'), name = "") +
labs(title="BSN overall cost over time for non-controlled system",x="time (s)", y="cost")
c4 = 0.53;
c3 = 0.50;
c2 = 0.47;
c1 = 0.44;
c_cost <- c_data %>%
mutate(color = if_else((c4*0.95<COST & COST<c4*1.05) ||
(c3*0.95<COST & COST<c3*1.05) ||
(c2*0.95<COST & COST<c2*1.05) ||
(c1*0.95<COST & COST<c1*1.05),"ok", "not ok")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000, COST, color=color)) +
stat_smooth(aes(TIME..ms./1000,COST), color='black', method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_hline(yintercept = c4*0.95, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = c4, color = 'black') +
#geom_hline(yintercept = c4*1.05, color = 'black', linetype=2, alpha=0.3) +
#geom_hline(yintercept = c3*0.95, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = c3, color = 'black') +
#geom_hline(yintercept = c3*1.05, color = 'black', linetype=2, alpha=0.3) +
#geom_hline(yintercept = c2*0.95, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = c2, color = 'black') +
#geom_hline(yintercept = c2*1.05, color = 'black', linetype=2, alpha=0.3) +
#geom_hline(yintercept = c1*0.95, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = c1, color = 'black') +
#geom_hline(yintercept = c1*1.05, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*0.15), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.15, name="active sensors")) +
scale_color_manual(values = c("ok" = 'blue', "not ok" = 'red'), name = "") +
labs(title="BSN overall cost over time for controlled system",x="time (s)", y="cost")
cost <- plot_grid(nc_cost, c_cost, ncol = 1, align = 'v')
# plot all
plot_grid(rel, cost)
# Experiments for 4B
## Reliability analysis
r <- 0.90
nc_rel <- nc_data %>%
mutate(color = if_else(RELIABILITY>=r*0.95 & RELIABILITY<=r*1.05, "88%<x<92%", "x<88% or x>92%")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000,RELIABILITY*100, color=color)) +
stat_smooth(aes(TIME..ms./1000,RELIABILITY*100), color='black', method = lm, formula = y ~ poly(x, 15), se = FALSE) +
#geom_hline(yintercept = (r*0.95)*100, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = (r*100), color = 'black') +
#geom_hline(yintercept = (r*1.05)*100, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./25, name="active sensors")) +
scale_color_manual(values = c("88%<x<92%" = 'blue', "x<88% or x>92%" = 'red'), name = "") +
labs(title="BSN overall reliability over time for non-controlled system",x="time (s)", y="reliability (%)")
#coord_cartesian(xlim=c(0, 30), ylim=c(0, 100))
c_rel <- c_data %>%
mutate(color = if_else(RELIABILITY>=r*0.95 & RELIABILITY<=r*1.05, "88%<x<92%", "x<88% or x>92%")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000,RELIABILITY*100, color=color)) +
stat_smooth(aes(TIME..ms./1000,RELIABILITY*100), color='black', method = lm, formula = y ~ poly(x, 15), se = FALSE) +
#geom_hline(yintercept = (r*0.95)*100, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = (r*100), color = 'black') +
#geom_hline(yintercept = (r*1.05)*100, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./25, name="active sensors")) +
scale_color_manual(values = c("88%<x<92%" = 'blue', "x<88% or x>92%" = 'red'), name = "") +
labs(title="BSN overall reliability over time for controlled system",x="time (s)", y="reliability (%)")
#coord_cartesian(xlim=c(0, 30), ylim=c(0, 100))
rel <- plot_grid(nc_rel, c_rel, ncol = 1, align = 'v')
## Cost analysis
c <- 0.47
nc_cost <- nc_data %>%
mutate(color = if_else(c*0.95<COST & COST<c*1.05,"ok", "not ok")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000, COST, color=color)) +
stat_smooth(aes(TIME..ms./1000,COST), color='black', method = lm, formula = y ~ poly(x, 15), se = FALSE) +
#geom_hline(yintercept = c*0.95, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = c, color = 'black') +
#geom_hline(yintercept = c*1.05, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*0.15), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.15, name="active sensors")) +
scale_color_manual(values = c("ok" = 'blue', "not ok" = 'red'), name = "") +
labs(title="BSN overall cost over time for non-controlled system",x="time (s)", y="cost")
c4 = 0.53;
c3 = 0.50;
c2 = 0.47;
c1 = 0.44;
c_cost <- c_data %>%
mutate(color = if_else((c4*0.95<COST & COST<c4*1.05) ||
(c3*0.95<COST & COST<c3*1.05) ||
(c2*0.95<COST & COST<c2*1.05) ||
(c1*0.95<COST & COST<c1*1.05),"ok", "not ok")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000, COST, color=color)) +
stat_smooth(aes(TIME..ms./1000,COST), color='black', method = lm, formula = y ~ poly(x, 15), se = FALSE) +
#geom_hline(yintercept = c4*0.95, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = c4, color = 'black') +
#geom_hline(yintercept = c4*1.05, color = 'black', linetype=2, alpha=0.3) +
#geom_hline(yintercept = c3*0.95, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = c3, color = 'black') +
#geom_hline(yintercept = c3*1.05, color = 'black', linetype=2, alpha=0.3) +
#geom_hline(yintercept = c2*0.95, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = c2, color = 'black') +
#geom_hline(yintercept = c2*1.05, color = 'black', linetype=2, alpha=0.3) +
#geom_hline(yintercept = c1*0.95, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = c1, color = 'black') +
#geom_hline(yintercept = c1*1.05, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*0.15), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.15, name="active sensors")) +
scale_color_manual(values = c("ok" = 'blue', "not ok" = 'red'), name = "") +
labs(title="BSN overall cost over time for controlled system",x="time (s)", y="cost")
cost <- plot_grid(nc_cost, c_cost, ncol = 1, align = 'v')
# plot all
plot_grid(rel, cost)
# Experiments for 4B
## Reliability analysis
r <- 0.90
rmin <- r*0.95
rmax <- r*1.05
nc_rel <- nc_data %>%
mutate(color = if_else(RELIABILITY>=rmin & RELIABILITY<=rmax, "88%<x<92%", "x<88% or x>92%")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000,RELIABILITY*100, color=color)) +
stat_smooth(aes(TIME..ms./1000,RELIABILITY*100), color='black', method = lm, formula = y ~ poly(x, 15), se = FALSE) +
#geom_hline(yintercept = rmin*100, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = r*100, color = 'black') +
#geom_hline(yintercept = rmax*100, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./25, name="active sensors")) +
scale_color_manual(values = c("88%<x<92%" = 'blue', "x<88% or x>92%" = 'red'), name = "") +
labs(title="BSN overall reliability over time for non-controlled system",x="time (s)", y="reliability (%)") +
coord_cartesian(xlim=c(0, 300), ylim=c(0, 100))
c_rel <- c_data %>%
mutate(color = if_else(RELIABILITY>=rmin & RELIABILITY<=rmax, "88%<x<92%", "x<88% or x>92%")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000,RELIABILITY*100, color=color)) +
stat_smooth(aes(TIME..ms./1000,RELIABILITY*100), color='black', method = lm, formula = y ~ poly(x, 15), se = FALSE) +
#geom_hline(yintercept = rmin*100, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = r*100, color = 'black') +
#geom_hline(yintercept = rmax*100, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./25, name="active sensors")) +
scale_color_manual(values = c("88%<x<92%" = 'blue', "x<88% or x>92%" = 'red'), name = "") +
labs(title="BSN overall reliability over time for controlled system",x="time (s)", y="reliability (%)") +
coord_cartesian(xlim=c(0, 300), ylim=c(0, 100))
rel <- plot_grid(nc_rel, c_rel, ncol = 1, align = 'v')
## Cost analysis
c <- 0.47
cmin <- c*0.95
cmax <- c*1.05
nc_cost <- nc_data %>%
mutate(color = if_else(cmin<COST & COST<cmax,"ok", "not ok")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000, COST, color=color)) +
stat_smooth(aes(TIME..ms./1000,COST), color='black', method = lm, formula = y ~ poly(x, 15), se = FALSE) +
#geom_hline(yintercept = cmin, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = c, color = 'black') +
#geom_hline(yintercept = cmax, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*0.15), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.15, name="active sensors")) +
scale_color_manual(values = c("ok" = 'blue', "not ok" = 'red'), name = "") +
labs(title="BSN overall cost over time for non-controlled system",x="time (s)", y="cost") +
coord_cartesian(xlim=c(0, 300), ylim=c(0, 100))
c_cost <- c_data %>%
mutate(color = if_else(,"ok", "not ok")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000, COST, color=color)) +
stat_smooth(aes(TIME..ms./1000,COST), color='black', method = lm, formula = y ~ poly(x, 15), se = FALSE) +
#geom_hline(yintercept = cmin, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = c, color = 'black') +
#geom_hline(yintercept = cmax, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*0.15), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.15, name="active sensors")) +
scale_color_manual(values = c("ok" = 'blue', "not ok" = 'red'), name = "") +
labs(title="BSN overall cost over time for controlled system",x="time (s)", y="cost") +
coord_cartesian(xlim=c(0, 300), ylim=c(0, 100))
cost <- plot_grid(nc_cost, c_cost, ncol = 1, align = 'v')
# plot all
plot_grid(rel, cost)
# Experiments for 4B
## Reliability analysis
r <- 0.90
rmin <- r*0.95
rmax <- r*1.05
nc_rel <- nc_data %>%
mutate(color = if_else(RELIABILITY>=rmin & RELIABILITY<=rmax, "88%<x<92%", "x<88% or x>92%")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000,RELIABILITY*100, color=color)) +
stat_smooth(aes(TIME..ms./1000,RELIABILITY*100), color='black', method = lm, formula = y ~ poly(x, 15), se = FALSE) +
#geom_hline(yintercept = rmin*100, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = r*100, color = 'black') +
#geom_hline(yintercept = rmax*100, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./25, name="active sensors")) +
scale_color_manual(values = c("88%<x<92%" = 'blue', "x<88% or x>92%" = 'red'), name = "") +
labs(title="BSN overall reliability over time for non-controlled system",x="time (s)", y="reliability (%)") +
coord_cartesian(xlim=c(0, 300), ylim=c(0, 100))
c_rel <- c_data %>%
mutate(color = if_else(RELIABILITY>=rmin & RELIABILITY<=rmax, "88%<x<92%", "x<88% or x>92%")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000,RELIABILITY*100, color=color)) +
stat_smooth(aes(TIME..ms./1000,RELIABILITY*100), color='black', method = lm, formula = y ~ poly(x, 15), se = FALSE) +
#geom_hline(yintercept = rmin*100, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = r*100, color = 'black') +
#geom_hline(yintercept = rmax*100, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./25, name="active sensors")) +
scale_color_manual(values = c("88%<x<92%" = 'blue', "x<88% or x>92%" = 'red'), name = "") +
labs(title="BSN overall reliability over time for controlled system",x="time (s)", y="reliability (%)") +
coord_cartesian(xlim=c(0, 300), ylim=c(0, 100))
rel <- plot_grid(nc_rel, c_rel, ncol = 1, align = 'v')
## Cost analysis
c <- 0.47
cmin <- c*0.95
cmax <- c*1.05
nc_cost <- nc_data %>%
mutate(color = if_else(cmin<COST & COST<cmax,"ok", "not ok")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000, COST, color=color)) +
stat_smooth(aes(TIME..ms./1000,COST), color='black', method = lm, formula = y ~ poly(x, 15), se = FALSE) +
#geom_hline(yintercept = cmin, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = c, color = 'black') +
#geom_hline(yintercept = cmax, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*0.15), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.15, name="active sensors")) +
scale_color_manual(values = c("ok" = 'blue', "not ok" = 'red'), name = "") +
labs(title="BSN overall cost over time for non-controlled system",x="time (s)", y="cost") +
coord_cartesian(xlim=c(0, 300), ylim=c(0, 100))
c_cost <- c_data %>%
mutate(color = if_else(cmin<COST & COST<cmax,"ok", "not ok")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000, COST, color=color)) +
stat_smooth(aes(TIME..ms./1000, COST), color='black', method = lm, formula = y ~ poly(x, 15), se = FALSE) +
#geom_hline(yintercept = cmin, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = c, color = 'black') +
#geom_hline(yintercept = cmax, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*0.15), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.15, name="active sensors")) +
scale_color_manual(values = c("ok" = 'blue', "not ok" = 'red'), name = "") +
labs(title="BSN overall cost over time for controlled system",x="time (s)", y="cost") +
coord_cartesian(xlim=c(0, 300), ylim=c(0, 100))
cost <- plot_grid(nc_cost, c_cost, ncol = 1, align = 'v')
# plot all
plot_grid(rel, cost)
## Cost analysis
c <- 0.47
cmin <- c*0.95
cmax <- c*1.05
nc_cost <- nc_data %>%
mutate(color = if_else(cmin<COST & COST<cmax,"ok", "not ok")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000, COST, color=color)) +
stat_smooth(aes(TIME..ms./1000,COST), color='black', method = lm, formula = y ~ poly(x, 15), se = FALSE) +
#geom_hline(yintercept = cmin, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = c, color = 'black') +
#geom_hline(yintercept = cmax, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*0.15), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.15, name="active sensors")) +
scale_color_manual(values = c("ok" = 'blue', "not ok" = 'red'), name = "") +
labs(title="BSN overall cost over time for non-controlled system",x="time (s)", y="cost") +
coord_cartesian(xlim=c(0, 300), ylim=c(0.6))
c_cost <- c_data %>%
mutate(color = if_else(cmin<COST & COST<cmax,"ok", "not ok")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000, COST, color=color)) +
stat_smooth(aes(TIME..ms./1000, COST), color='black', method = lm, formula = y ~ poly(x, 15), se = FALSE) +
#geom_hline(yintercept = cmin, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = c, color = 'black') +
#geom_hline(yintercept = cmax, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*0.15), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.15, name="active sensors")) +
scale_color_manual(values = c("ok" = 'blue', "not ok" = 'red'), name = "") +
labs(title="BSN overall cost over time for controlled system",x="time (s)", y="cost") +
coord_cartesian(xlim=c(0, 300), ylim=c(0, 0.6))
cost <- plot_grid(nc_cost, c_cost, ncol = 1, align = 'v')
plot_grid(rel, cost)
# Experiments for 4B
## Reliability analysis
r <- 0.90
rmin <- r*0.95
rmax <- r*1.05
nc_rel <- nc_data %>%
mutate(color = if_else(RELIABILITY>=rmin & RELIABILITY<=rmax, "88%<x<92%", "x<88% or x>92%")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000,RELIABILITY*100, color=color)) +
stat_smooth(aes(TIME..ms./1000,RELIABILITY*100), color='black', method = lm, formula = y ~ poly(x, 15), se = FALSE) +
#geom_hline(yintercept = rmin*100, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = r*100, color = 'black') +
#geom_hline(yintercept = rmax*100, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./25, name="active sensors")) +
scale_color_manual(values = c("88%<x<92%" = 'blue', "x<88% or x>92%" = 'red'), name = "") +
labs(title="BSN overall reliability over time for non-controlled system",x="time (s)", y="reliability (%)") +
coord_cartesian(xlim=c(0, 300), ylim=c(0, 100))
c_rel <- c_data %>%
mutate(color = if_else(RELIABILITY>=rmin & RELIABILITY<=rmax, "88%<x<92%", "x<88% or x>92%")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000,RELIABILITY*100, color=color)) +
stat_smooth(aes(TIME..ms./1000,RELIABILITY*100), color='black', method = lm, formula = y ~ poly(x, 15), se = FALSE) +
#geom_hline(yintercept = rmin*100, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = r*100, color = 'black') +
#geom_hline(yintercept = rmax*100, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./25, name="active sensors")) +
scale_color_manual(values = c("88%<x<92%" = 'blue', "x<88% or x>92%" = 'red'), name = "") +
labs(title="BSN overall reliability over time for controlled system",x="time (s)", y="reliability (%)") +
coord_cartesian(xlim=c(0, 300), ylim=c(0, 100))
rel <- plot_grid(nc_rel, c_rel, ncol = 1, align = 'v')
## Cost analysis
c <- 0.47
cmin <- c*0.95
cmax <- c*1.05
nc_cost <- nc_data %>%
mutate(color = if_else(cmin<=COST & COST<=cmax,"ok", "not ok")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000,COST, color=color)) +
stat_smooth(aes(TIME..ms./1000,COST), color='black', method = lm, formula = y ~ poly(x, 15), se = FALSE) +
#geom_hline(yintercept = cmin, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = c, color = 'black') +
#geom_hline(yintercept = cmax, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*0.15), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.15, name="active sensors")) +
scale_color_manual(values = c("ok" = 'blue', "not ok" = 'red'), name = "") +
labs(title="BSN overall cost over time for non-controlled system",x="time (s)", y="cost") +
coord_cartesian(xlim=c(0, 300), ylim=c(0.6))
c_cost <- c_data %>%
mutate(color = if_else(cmin<=COST & COST<=cmax,"ok", "not ok")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000, COST, color=color)) +
stat_smooth(aes(TIME..ms./1000, COST), color='black', method = lm, formula = y ~ poly(x, 15), se = FALSE) +
#geom_hline(yintercept = cmin, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = c, color = 'black') +
#geom_hline(yintercept = cmax, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*0.15), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.15, name="active sensors")) +
scale_color_manual(values = c("ok" = 'blue', "not ok" = 'red'), name = "") +
labs(title="BSN overall cost over time for controlled system",x="time (s)", y="cost") +
coord_cartesian(xlim=c(0, 300), ylim=c(0, 0.6))
cost <- plot_grid(nc_cost, c_cost, ncol = 1, align = 'v')
# plot all
plot_grid(rel, cost)
# Experiments for 4B
## Reliability analysis
r <- 0.90
rmin <- r*0.95
rmax <- r*1.05
nc_rel <- nc_data %>%
mutate(color = if_else(RELIABILITY>=rmin & RELIABILITY<=rmax, "88%<x<92%", "x<88% or x>92%")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000,RELIABILITY*100, color=color)) +
stat_smooth(aes(TIME..ms./1000,RELIABILITY*100), color='black', method = lm, formula = y ~ poly(x, 15), se = FALSE) +
#geom_hline(yintercept = rmin*100, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = r*100, color = 'black') +
#geom_hline(yintercept = rmax*100, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./25, name="active sensors")) +
scale_color_manual(values = c("88%<x<92%" = 'blue', "x<88% or x>92%" = 'red'), name = "") +
labs(title="BSN overall reliability over time for non-controlled system",x="time (s)", y="reliability (%)") +
coord_cartesian(xlim=c(0, 300), ylim=c(0, 100))
c_rel <- c_data %>%
mutate(color = if_else(RELIABILITY>=rmin & RELIABILITY<=rmax, "88%<x<92%", "x<88% or x>92%")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000,RELIABILITY*100, color=color)) +
stat_smooth(aes(TIME..ms./1000,RELIABILITY*100), color='black', method = lm, formula = y ~ poly(x, 15), se = FALSE) +
#geom_hline(yintercept = rmin*100, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = r*100, color = 'black') +
#geom_hline(yintercept = rmax*100, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./25, name="active sensors")) +
scale_color_manual(values = c("88%<x<92%" = 'blue', "x<88% or x>92%" = 'red'), name = "") +
labs(title="BSN overall reliability over time for controlled system",x="time (s)", y="reliability (%)") +
coord_cartesian(xlim=c(0, 300), ylim=c(0, 100))
rel <- plot_grid(nc_rel, c_rel, ncol = 1, align = 'v')
## Cost analysis
c <- 0.47
cmin <- c*0.95
cmax <- c*1.05
nc_cost <- nc_data %>%
mutate(color = if_else(cmin<=COST & COST<=cmax,"ok", "not ok")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000,COST, color=color)) +
stat_smooth(aes(TIME..ms./1000,COST), color='black', method = lm, formula = y ~ poly(x, 15), se = FALSE) +
#geom_hline(yintercept = cmin, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = c, color = 'black') +
#geom_hline(yintercept = cmax, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*0.15), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.15, name="active sensors")) +
scale_color_manual(values = c("ok" = 'blue', "not ok" = 'red'), name = "") +
labs(title="BSN overall cost over time for non-controlled system",x="time (s)", y="cost") +
coord_cartesian(xlim=c(0, 300), ylim=c(0, 0.6))
c_cost <- c_data %>%
mutate(color = if_else(cmin<=COST & COST<=cmax,"ok", "not ok")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000, COST, color=color)) +
stat_smooth(aes(TIME..ms./1000, COST), color='black', method = lm, formula = y ~ poly(x, 15), se = FALSE) +
#geom_hline(yintercept = cmin, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = c, color = 'black') +
#geom_hline(yintercept = cmax, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*0.15), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.15, name="active sensors")) +
scale_color_manual(values = c("ok" = 'blue', "not ok" = 'red'), name = "") +
labs(title="BSN overall cost over time for controlled system",x="time (s)", y="cost") +
coord_cartesian(xlim=c(0, 300), ylim=c(0, 0.6))
cost <- plot_grid(nc_cost, c_cost, ncol = 1, align = 'v')
# plot all
plot_grid(rel, cost)
# Experiments for 4B
## Reliability analysis
r <- 0.90
rmin <- r*0.95
rmax <- r*1.05
nc_rel <- nc_data %>%
mutate(color = if_else(RELIABILITY>=rmin & RELIABILITY<=rmax, "88%<x<92%", "x<88% or x>92%")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000,RELIABILITY*100, color=color)) +
stat_smooth(aes(TIME..ms./1000,RELIABILITY*100), color='black', method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_hline(yintercept = rmin*100, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = r*100, color = 'black') +
#geom_hline(yintercept = rmax*100, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./25, name="active sensors")) +
scale_color_manual(values = c("88%<x<92%" = 'blue', "x<88% or x>92%" = 'red'), name = "") +
labs(title="BSN overall reliability over time for non-controlled system",x="time (s)", y="reliability (%)") +
coord_cartesian(xlim=c(0, 300), ylim=c(0, 100))
c_rel <- c_data %>%
mutate(color = if_else(RELIABILITY>=rmin & RELIABILITY<=rmax, "88%<x<92%", "x<88% or x>92%")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000,RELIABILITY*100, color=color)) +
stat_smooth(aes(TIME..ms./1000,RELIABILITY*100), color='black', method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_hline(yintercept = rmin*100, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = r*100, color = 'black') +
#geom_hline(yintercept = rmax*100, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./25, name="active sensors")) +
scale_color_manual(values = c("88%<x<92%" = 'blue', "x<88% or x>92%" = 'red'), name = "") +
labs(title="BSN overall reliability over time for controlled system",x="time (s)", y="reliability (%)") +
coord_cartesian(xlim=c(0, 300), ylim=c(0, 100))
rel <- plot_grid(nc_rel, c_rel, ncol = 1, align = 'v')
## Cost analysis
c <- 0.47
cmin <- c*0.95
cmax <- c*1.05
nc_cost <- nc_data %>%
mutate(color = if_else(cmin<=COST & COST<=cmax,"ok", "not ok")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000,COST, color=color)) +
stat_smooth(aes(TIME..ms./1000,COST), color='black', method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_hline(yintercept = cmin, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = c, color = 'black') +
#geom_hline(yintercept = cmax, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*0.15), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.15, name="active sensors")) +
scale_color_manual(values = c("ok" = 'blue', "not ok" = 'red'), name = "") +
labs(title="BSN overall cost over time for non-controlled system",x="time (s)", y="cost") +
coord_cartesian(xlim=c(0, 300), ylim=c(0, 0.6))
c_cost <- c_data %>%
mutate(color = if_else(cmin<=COST & COST<=cmax,"ok", "not ok")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000, COST, color=color)) +
stat_smooth(aes(TIME..ms./1000, COST), color='black', method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_hline(yintercept = cmin, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = c, color = 'black') +
#geom_hline(yintercept = cmax, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*0.15), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.15, name="active sensors")) +
scale_color_manual(values = c("ok" = 'blue', "not ok" = 'red'), name = "") +
labs(title="BSN overall cost over time for controlled system",x="time (s)", y="cost") +
coord_cartesian(xlim=c(0, 300), ylim=c(0, 0.6))
cost <- plot_grid(nc_cost, c_cost, ncol = 1, align = 'v')
# plot all
plot_grid(rel, cost)

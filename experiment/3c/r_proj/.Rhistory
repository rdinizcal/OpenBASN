stat_smooth(aes(TIME..ms./1000,RELIABILITY*100), color='black', method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 88, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 90, color = 'black') +
geom_hline(yintercept = 92, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./25, name="active sensors")) +
scale_color_manual(values = c("88%<x<92%" = 'blue', "x>88% or x>92%" = 'red'), name = "") +
labs(title="BSN overall reliability over time for non-controlled system",x="time (s)", y="reliability (%)")
#coord_cartesian(xlim=c(0, 30), ylim=c(0, 100))
c_rel <- c_data %>%
mutate(color = if_else(RELIABILITY>0.88 & RELIABILITY<.92, "88%<x<92%", "x>88% or x>92%")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000,RELIABILITY*100, color=color)) +
stat_smooth(aes(TIME..ms./1000,RELIABILITY*100), color='black', method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 88, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 90, color = 'black') +
geom_hline(yintercept = 92, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./25, name="active sensors")) +
scale_color_manual(values = c("88%<x<92%" = 'blue', "x>88% or x>92%" = 'red'), name = "") +
labs(title="BSN overall reliability over time for controlled system",x="time (s)", y="reliability (%)")
#coord_cartesian(xlim=c(0, 30), ylim=c(0, 100))
plot_grid(rel, cost)
f_nc_data <- filter(nc_data, TIME..ms.<150000)
f_c_data  <- filter(c_data,  TIME..ms.<150000)
ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 0.56, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 0.53, color = 'black') +
geom_hline(yintercept = 0.50, color = 'black', linetype=2, alpha=0.3) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
labs(x="time (s)", y="reliability (%)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 100))
f_nc_data <- filter(nc_data, TIME..ms.<150000)
f_c_data  <- filter(c_data,  TIME..ms.<150000)
ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 0.56, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 0.53, color = 'black') +
geom_hline(yintercept = 0.50, color = 'black', linetype=2, alpha=0.3) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
labs(x="time (s)", y="reliability (%)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 0.56))
f_nc_data <- filter(nc_data, TIME..ms.<150000)
f_c_data  <- filter(c_data,  TIME..ms.<150000)
ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 0.56, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 0.53, color = 'black') +
geom_hline(yintercept = 0.50, color = 'black', linetype=2, alpha=0.3) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
labs(x="time (s)", y="reliability (%)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 0.60))
f_nc_data <- filter(nc_data, TIME..ms.<150000)
f_c_data  <- filter(c_data,  TIME..ms.<150000)
ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 0.56, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 0.53, color = 'black') +
geom_hline(yintercept = 0.50, color = 'black', linetype=2, alpha=0.3) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
labs(x="time (s)", y="reliability (%)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 0.70))
f_nc_data <- filter(nc_data, TIME..ms.<150000)
f_c_data  <- filter(c_data,  TIME..ms.<150000)
ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 0.56, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 0.53, color = 'black') +
geom_hline(yintercept = 0.50, color = 'black', linetype=2, alpha=0.3) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
labs(x="time (s)", y="reliability (%)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 0.63))
f_nc_data <- filter(nc_data, TIME..ms.<150000)
f_c_data  <- filter(c_data,  TIME..ms.<150000)
ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 0.5406, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 0.53, color = 'black') +
geom_hline(yintercept = 0.5194, color = 'black', linetype=2, alpha=0.3) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
labs(x="time (s)", y="reliability (%)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 0.63))
f_nc_data <- filter(nc_data, TIME..ms.<150000)
f_c_data  <- filter(c_data,  TIME..ms.<150000)
ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 0.5406, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 0.53, color = 'black') +
geom_hline(yintercept = 0.5194, color = 'black', linetype=2, alpha=0.3) +
geom_text(aes( 1, 0.51, label = "0.53 w set point", vjust = -1), size = 3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.0015, name="active sensors")) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
labs(x="time (s)", y="cost (w)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 0.63))
c_cost <- c_data %>%
mutate(color = if_else(0.0050<COST & COST<0.0056, "0.0050<x<0.0056", "x<0.0050 or x>0.0056")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000, COST, color=color)) +
stat_smooth(aes(TIME..ms./1000,COST), color='black', method = lm, formula = y ~ poly(x, 25), se = FALSE) +
geom_hline(yintercept = 0.0056, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 0.0053, color = 'black') +
geom_hline(yintercept = 0.0050, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*0.0015), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.0015, name="active sensors")) +
scale_color_manual(values = c("0.0050<x<0.0056" = 'blue', "x<0.0050 or x>0.0056" = 'red'), name = "") +
labs(title="BSN overall cost over time for controlled system",x="time (s)", y="cost")
ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 0.5406, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 0.53, color = 'black') +
geom_hline(yintercept = 0.5194, color = 'black', linetype=2, alpha=0.3) +
geom_text(aes( 1, 0.50, label = "0.53 w set point", vjust = -1), size = 3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.0015, name="active sensors")) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
labs(x="time (s)", y="cost (w)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 0.63))
f_nc_data <- filter(nc_data, TIME..ms.<150000)
f_c_data  <- filter(c_data,  TIME..ms.<150000)
ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 0.5406, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 0.53, color = 'black') +
geom_hline(yintercept = 0.5194, color = 'black', linetype=2, alpha=0.3) +
geom_text(aes( 1, 0.515, label = "0.53 w set point", vjust = -1), size = 3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.0015, name="active sensors")) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
labs(x="time (s)", y="cost (w)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 0.63))
f_nc_data <- filter(nc_data, TIME..ms.<150000)
f_c_data  <- filter(c_data,  TIME..ms.<150000)
ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 0.5406, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 0.53, color = 'black') +
geom_hline(yintercept = 0.5194, color = 'black', linetype=2, alpha=0.3) +
geom_text(aes( 2, 0.515, label = "0.53 w set point", vjust = -1), size = 3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.0015, name="active sensors")) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
labs(x="time (s)", y="cost (w)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 0.63))
f_nc_data <- filter(nc_data, TIME..ms.<150000)
f_c_data  <- filter(c_data,  TIME..ms.<150000)
ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 0.5406, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 0.53, color = 'black') +
geom_hline(yintercept = 0.5194, color = 'black', linetype=2, alpha=0.3) +
geom_text(aes( 3, 0.515, label = "0.53 w set point", vjust = -1), size = 3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.0015, name="active sensors")) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
labs(x="time (s)", y="cost (w)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 0.63))
f_nc_data <- filter(nc_data, TIME..ms.<150000)
f_c_data  <- filter(c_data,  TIME..ms.<150000)
ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, RELIABILITY*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, RELIABILITY*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 88, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 90, color = 'black') +
geom_hline(yintercept = 92, color = 'black', linetype=2, alpha=0.3) +
geom_text(aes( 1, 88, label = "90% set point", vjust = -1), size = 3) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
labs(x="time (s)", y="reliability (%)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 100))
f_nc_data <- filter(nc_data, TIME..ms.<150000)
f_c_data  <- filter(c_data,  TIME..ms.<150000)
ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, RELIABILITY*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, RELIABILITY*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 88, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 90, color = 'black') +
geom_hline(yintercept = 92, color = 'black', linetype=2, alpha=0.3) +
geom_text(aes( 2, 88, label = "90% set point", vjust = -1), size = 3) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
labs(x="time (s)", y="reliability (%)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 100))
f_nc_data <- filter(nc_data, TIME..ms.<150000)
f_c_data  <- filter(c_data,  TIME..ms.<150000)
ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 0.5406, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 0.53, color = 'black') +
geom_hline(yintercept = 0.5194, color = 'black', linetype=2, alpha=0.3) +
geom_text(aes( 3, 0.515, label = "0.53 w set point", vjust = -1), size = 3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.0015, name="active sensors")) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
labs(x="time (s)", y="cost (w)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 0.63))
ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 0.5406, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 0.53, color = 'black') +
geom_hline(yintercept = 0.5194, color = 'black', linetype=2, alpha=0.3) +
geom_text(aes( 3, 0.515, label = "0.53 w set point", vjust = -1), size = 3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.000015, name="active sensors")) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
labs(x="time (s)", y="cost (w)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 0.63))
f_nc_data <- filter(nc_data, TIME..ms.<150000)
f_c_data  <- filter(c_data,  TIME..ms.<150000)
ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 0.5406, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 0.53, color = 'black') +
geom_hline(yintercept = 0.5194, color = 'black', linetype=2, alpha=0.3) +
geom_text(aes( 3, 0.515, label = "0.53 w set point", vjust = -1), size = 3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.15, name="active sensors")) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
labs(x="time (s)", y="cost (w)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 0.63))
f_nc_data <- filter(nc_data, TIME..ms.<150000)
f_c_data  <- filter(c_data,  TIME..ms.<150000)
ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*0.0015, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 0.5406, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 0.53, color = 'black') +
geom_hline(yintercept = 0.5194, color = 'black', linetype=2, alpha=0.3) +
geom_text(aes( 3, 0.515, label = "0.53 w set point", vjust = -1), size = 3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.15, name="active sensors")) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
labs(x="time (s)", y="cost (w)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 0.63))
f_nc_data <- filter(nc_data, TIME..ms.<150000)
f_c_data  <- filter(c_data,  TIME..ms.<150000)
ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*0.15, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 0.5406, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 0.53, color = 'black') +
geom_hline(yintercept = 0.5194, color = 'black', linetype=2, alpha=0.3) +
geom_text(aes( 3, 0.515, label = "0.53 w set point", vjust = -1), size = 3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.15, name="active sensors")) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
labs(x="time (s)", y="cost (w)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 0.63))
y <- ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*0.15, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 0.5406, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 0.53, color = 'black') +
geom_hline(yintercept = 0.5194, color = 'black', linetype=2, alpha=0.3) +
geom_text(aes( 3, 0.515, label = "0.53 w set point", vjust = -1), size = 3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.15, name="active sensors")) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
labs(x="time (s)", y="cost (w)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 0.63))
plot_grid(x, y, nrow=1, align = 'h')
x <- ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, RELIABILITY*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, RELIABILITY*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 88, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 90, color = 'black') +
geom_hline(yintercept = 92, color = 'black', linetype=2, alpha=0.3) +
geom_text(aes( 2, 88, label = "90% set point", vjust = -1), size = 3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.0015, name="active sensors")) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
labs(x="time (s)", y="reliability (%)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 100))
plot_grid(x, y, nrow=1, align = 'h')
### Both in the same graph
f_nc_data <- filter(nc_data, TIME..ms.<150000)
f_c_data  <- filter(c_data,  TIME..ms.<150000)
x <- ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, RELIABILITY*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, RELIABILITY*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 88, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 90, color = 'black') +
geom_hline(yintercept = 92, color = 'black', linetype=2, alpha=0.3) +
geom_text(aes( 2, 88, label = "90% set point", vjust = -1), size = 3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.0015, name="active sensors")) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
theme(legend.position="none") +
labs(x="time (s)", y="reliability (%)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 100))
y <- ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*0.15, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 0.5406, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 0.53, color = 'black') +
geom_hline(yintercept = 0.5194, color = 'black', linetype=2, alpha=0.3) +
geom_text(aes( 3, 0.515, label = "0.53 w set point", vjust = -1), size = 3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.15, name="active sensors")) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
theme(legend.position="none") +
labs(x="time (s)", y="cost (w)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 0.63))
plot_grid(x, y, nrow=1, align = 'h')
c_cost <- c_data %>%
mutate(color = if_else(0.0050<COST & COST<0.0056, "0.0050<x<0.0056", "x<0.0050 or x>0.0056")) %>%
ggplot() +
geom_point(aes(TIME..ms./1000, COST, color=color)) +
stat_smooth(aes(TIME..ms./1000,COST), color='black', method = lm, formula = y ~ poly(x, 25), se = FALSE) +
geom_hline(yintercept = 0.0056, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 0.0053, color = 'black') +
geom_hline(yintercept = 0.0050, color = 'black', linetype=2, alpha=0.3) +
geom_line(aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*0.0015), alpha=0.3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.0015, name="active sensors")) +
scale_color_manual(values = c("0.0050<x<0.0056" = 'blue', "x<0.0050 or x>0.0056" = 'red'), name = "") +
labs(title="BSN overall cost over time for controlled system",x="time (s)", y="cost")
x <- ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, RELIABILITY*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, RELIABILITY*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 88, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 90, color = 'black') +
geom_hline(yintercept = 92, color = 'black', linetype=2, alpha=0.3) +
geom_text(aes( 2, 88, label = "90% set point", vjust = -1), size = 3) +
scale_y_continuous(sec.axis = sec_axis(~ ./25, name="active sensors")) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
theme(legend.position="none") +
labs(x="time (s)", y="reliability (%)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 100))
plot_grid(x, y, nrow=1, align = 'h')
plot_grid(x, y, ncol = 1, align = 'v')
### Both in the same graph
f_nc_data <- filter(nc_data, TIME..ms.<150000)
f_c_data  <- filter(c_data,  TIME..ms.<150000)
x <- ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, RELIABILITY*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, RELIABILITY*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 88, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 90, color = 'black') +
geom_hline(yintercept = 92, color = 'black', linetype=2, alpha=0.3) +
geom_text(aes( 2, 88, label = "90% set point", vjust = -1), size = 3) +
scale_y_continuous(sec.axis = sec_axis(~ ./25, name="active sensors")) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
theme(legend.position="none") +
labs(x="time (s)", y="reliability (%)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 100))
y <- ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*0.15, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 0.5406, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 0.53, color = 'black') +
geom_hline(yintercept = 0.5194, color = 'black', linetype=2, alpha=0.3) +
geom_text(aes( 3, 0.515, label = "0.53 w set point", vjust = -1), size = 3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.15, name="active sensors")) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
theme(legend.position="none") +
labs(x="time (s)", y="cost (w)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 0.63))
grobs <- ggplotGrob(pfour)$grobs
legend <- grobs[[which(sapply(grobs, function(x) x$name) == "guide-box")]]
plot_grid(x, y, legend, ncol = 1, align = 'v')
library(gridGraphics)
install.packages("gridGraphics")
library(gridGraphics)
f_nc_data <- filter(nc_data, TIME..ms.<150000)
f_c_data  <- filter(c_data,  TIME..ms.<150000)
x <- ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, RELIABILITY*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, RELIABILITY*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 88, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 90, color = 'black') +
geom_hline(yintercept = 92, color = 'black', linetype=2, alpha=0.3) +
geom_text(aes( 2, 88, label = "90% set point", vjust = -1), size = 3) +
scale_y_continuous(sec.axis = sec_axis(~ ./25, name="active sensors")) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
theme(legend.position="none") +
labs(x="time (s)", y="reliability (%)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 100))
y <- ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*0.15, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 0.5406, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 0.53, color = 'black') +
geom_hline(yintercept = 0.5194, color = 'black', linetype=2, alpha=0.3) +
geom_text(aes( 3, 0.515, label = "0.53 w set point", vjust = -1), size = 3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.15, name="active sensors")) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
theme(legend.position="none") +
labs(x="time (s)", y="cost (w)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 0.63))
grobs <- ggplotGrob(pfour)$grobs
legend <- grobs[[which(sapply(grobs, function(x) x$name) == "guide-box")]]
plot_grid(x, y, legend, ncol = 1, align = 'v')
legend <- grobs[[which(sapply(grobs, function(x) x$name) == "guide-box")]]
grobs <- ggplotGrob(pfour)$grobs
legend <- grobs[[which(sapply(grobs, function(x) x$name) == "guide-box")]]
grobs <- ggplotGrob(pfour)$grobs
legend <- grobs[[which(sapply(grobs, function(x) x$name) == "guide-box")]]
legend <- get_legend(x)
plot_grid(x, y, legend, ncol = 1, align = 'v')
legend <- get_legend(x)
x <- ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*25, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, RELIABILITY*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, RELIABILITY*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, RELIABILITY*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 88, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 90, color = 'black') +
geom_hline(yintercept = 92, color = 'black', linetype=2, alpha=0.3) +
geom_text(aes( 2, 88, label = "90% set point", vjust = -1), size = 3) +
scale_y_continuous(sec.axis = sec_axis(~ ./25, name="active sensors")) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
#theme(legend.position="none") +
labs(x="time (s)", y="reliability (%)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 100))
y <- ggplot() +
geom_line(data=nc_data, aes(TIME..ms./1000,(OXIM+ECG+TEMP+ABP)*0.15, color='active sensors')) +
#geom_point(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled')) +
stat_smooth(data=f_nc_data,aes(TIME..ms./1000, COST*100,  color='non controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
#geom_point(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled')) +
stat_smooth(data=f_c_data,aes(TIME..ms./1000, COST*100, color='controlled'), method = lm, formula = y ~ poly(x, 20), se = FALSE) +
geom_hline(yintercept = 0.5406, color = 'black', linetype=2, alpha=0.3) +
geom_hline(yintercept = 0.53, color = 'black') +
geom_hline(yintercept = 0.5194, color = 'black', linetype=2, alpha=0.3) +
geom_text(aes( 3, 0.515, label = "0.53 w set point", vjust = -1), size = 3) +
scale_y_continuous(sec.axis = sec_axis(~ ./0.15, name="active sensors")) +
scale_color_manual(values = c("controlled" = 'blue', "non controlled" = 'red', "active sensors" = 'grey'), name = "") +
theme(legend.position="none") +
labs(x="time (s)", y="cost (w)") +
coord_cartesian(xlim=c(0, 50), ylim=c(0, 0.63))
legend <- get_legend(x)
plot_grid(x, y, legend, ncol = 1, align = 'v')
